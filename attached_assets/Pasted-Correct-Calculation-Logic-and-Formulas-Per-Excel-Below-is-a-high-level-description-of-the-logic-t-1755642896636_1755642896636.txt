Correct Calculation Logic and Formulas (Per Excel)

Below is a highâ€‘level description of the logic that should be implemented to align with the Excel sheet, with formulas annotated to guide your developer.

2.1 Cost per Square Foot and Budgets

New Construction Cost Min/Max

NewÂ CostÂ Min
=
CostRangesLookup
(
ğ‘‘
ğ‘’
ğ‘ 
ğ‘–
ğ‘”
ğ‘›
ğ¿
ğ‘’
ğ‘£
ğ‘’
ğ‘™
,
Low
)
Ã—
HistoricMultiplier
NewÂ CostÂ Min=CostRangesLookup(designLevel,Low)Ã—HistoricMultiplier
NewÂ CostÂ Max
=
CostRangesLookup
(
ğ‘‘
ğ‘’
ğ‘ 
ğ‘–
ğ‘”
ğ‘›
ğ¿
ğ‘’
ğ‘£
ğ‘’
ğ‘™
,
High
)
Ã—
HistoricMultiplier
NewÂ CostÂ Max=CostRangesLookup(designLevel,High)Ã—HistoricMultiplier

(Where CostRangesLookup returns columns 6 and 7 from the Cost_Ranges table.)

New Construction Target
Default to the midâ€‘point:

NewCostTarget
=
NewÂ CostÂ Min
+
NewÂ CostÂ Max
2
NewCostTarget=
2
NewÂ CostÂ Min+NewÂ CostÂ Max
	â€‹


but allow the user to adjust it via a slider.

Remodel Cost Min/Max

RemodelÂ CostÂ Min
=
NewÂ CostÂ Min
Ã—
RemodelMultiplier
RemodelÂ CostÂ Min=NewÂ CostÂ MinÃ—RemodelMultiplier
RemodelÂ CostÂ Max
=
NewÂ CostÂ Max
Ã—
RemodelMultiplier
RemodelÂ CostÂ Max=NewÂ CostÂ MaxÃ—RemodelMultiplier

with target similarly midâ€‘point or userâ€‘selected.

Budgets

NewBudget
=
NewArea
Ã—
NewCostTarget
NewBudget=NewAreaÃ—NewCostTarget
RemodelBudget
=
ExistingArea
Ã—
RemodelCostTarget
RemodelBudget=ExistingAreaÃ—RemodelCostTarget
TotalBudget
=
NewBudget
+
RemodelBudget
TotalBudget=NewBudget+RemodelBudget

Component Budgets
Use the Shell/Interior/Landscape shares from the Cost_Ranges table (columns 8â€“10) or user overrides:

	
ShellBudgetNew
	
=
NewBudget
Ã—
ShellShare
		
	
ShellBudgetRemodel
	
=
RemodelBudget
Ã—
ShellShare
		
	
ShellBudgetTotal
	
=
ShellBudgetNew
+
ShellBudgetRemodel
		
ShellBudgetNew
ShellBudgetRemodel
ShellBudgetTotal
	â€‹

=NewBudgetÃ—ShellShare
=RemodelBudgetÃ—ShellShare
=ShellBudgetNew+ShellBudgetRemodel
	â€‹

	â€‹


and analogously for Interior and Landscape.

2.2 Engineering Discipline Budgets

Lookup discipline shares from the Engineering_Costs table by building use/type and tier:

Structural

StructuralBudget
=
(
ShellBudgetNew
Ã—
structuralShare
)
+
(
ShellBudgetRemodel
Ã—
structuralShare
Ã—
RemodelMultiplier
)
StructuralBudget=(ShellBudgetNewÃ—structuralShare)+(ShellBudgetRemodelÃ—structuralShareÃ—RemodelMultiplier)

Only structural remodel gets the 50â€¯% reduction; the other disciplines use the full remodel portion.

Other Disciplines

CivilBudget
=
ShellBudgetNew
Ã—
civilShare
+
ShellBudgetRemodel
Ã—
civilShare
CivilBudget=ShellBudgetNewÃ—civilShare+ShellBudgetRemodelÃ—civilShare

(and similarly for Mechanical, Electrical, Plumbing, and Telecommunication).

Architecture Budget

ArchitectureBudget
=
ShellBudgetTotal
âˆ’
âˆ‘
(
disciplineÂ budgets
)
ArchitectureBudget=ShellBudgetTotalâˆ’âˆ‘(disciplineÂ budgets)

(the remainder of shell cost after engineering.)

2.3 Topâ€‘Down Fee Calculation

Use the nonâ€‘linear fee curve constants A=0.07498, B=0.007824, P=âˆ’0.7495.

For each discipline, compute its fee percentage of the project cost:

basePct
=
ğ´
+
ğµ
Ã—
(
BudgetRef
1,000,000
)
ğ‘ƒ
basePct=A+BÃ—(
1,000,000
BudgetRef
	â€‹

)
P
feePct
=
basePct
Ã—
CategoryMultiplier
Ã—
0.95
Ã—
NewBudget
+
1.05
Ã—
RemodelBudget
TotalBudget
feePct=basePctÃ—CategoryMultiplierÃ—
TotalBudget
0.95Ã—NewBudget+1.05Ã—RemodelBudget
	â€‹


If the discipline is Architecture, Interior Design, or Landscape Architecture, multiply the feePct by 
(
1
+
(
1
âˆ’
RemodelMultiplier
)
)
(1+(1âˆ’RemodelMultiplier)).
Set BudgetRef to the shell budget for architecture, the interior budget for interior design, and the disciplineâ€™s own budget for engineering disciplines (structural, civil, mechanical, electrical, plumbing, telecom).

Then compute:

MarketFee
=
feePct
Ã—
ScopeBudget
MarketFee=feePctÃ—ScopeBudget
RatePerFtÂ²
=
MarketFee
TotalArea
RatePerFtÂ²=
TotalArea
MarketFee
	â€‹


If the discipline is outsourced, set LouisAmyFee = 0, ConsultantFee = MarketFee and CoordinationFee = MarketFee Ã— 0.15 (15â€¯% coordination). Otherwise, LouisAmyFee = MarketFee, ConsultantFee = 0, and CoordinationFee = 0.

2.4 Bottomâ€‘Up Fee Calculation

For the bottomâ€‘up calculation, let:

Labour Rate 
ğ‘Ÿ
labour
r
labour
	â€‹

 (e.g., $26/hr from your data).

Overhead per hour 
ğ‘Ÿ
overhead
r
overhead
	â€‹

 (e.g., $46/hr â€“ note the 46.00 vs 4600 bug).

Markup factor (e.g., 1.5 = 50â€¯% markup).

Discount 
ğ‘‘
d (e.g., 0 if no discount).

Then:

TotalHours
=
(
NewArea
+
ExistingArea
)
Ã—
HoursPerFtÂ²Factor
TotalHours=(NewArea+ExistingArea)Ã—HoursPerFtÂ²Factor
LabourCost
=
TotalHours
Ã—
ğ‘Ÿ
labour
LabourCost=TotalHoursÃ—r
labour
	â€‹

WithOverhead
=
LabourCost
+
(
TotalHours
Ã—
ğ‘Ÿ
overhead
)
WithOverhead=LabourCost+(TotalHoursÃ—r
overhead
	â€‹

)
WithMarkup
=
WithOverhead
Ã—
MarkupFactor
WithMarkup=WithOverheadÃ—MarkupFactor
BottomUpFee
=
WithMarkup
Ã—
(
1
âˆ’
ğ‘‘
)
BottomUpFee=WithMarkupÃ—(1âˆ’d)

Users should be able to set 
ğ‘Ÿ
labour
,
ğ‘Ÿ
overhead
,
r
labour
	â€‹

,r
overhead
	â€‹

, markup, and discount, as well as override the hours-perâ€‘ftÂ² factor.

2.5 Hours and Phase Distribution

Instead of a single hours-perâ€‘ftÂ² slider, use the original nonâ€‘linear formula from the Excel sheet:

hoursFactor
=
(
0.21767
+
11.21274
Ã—
(
Area
âˆ’
0.53816
)
âˆ’
0.08
)
Ã—
CategoryMultiplier
hoursFactor=(0.21767+11.21274Ã—(Area
âˆ’0.53816
)âˆ’0.08)Ã—CategoryMultiplier

Use 0.9 on the new area and 0.8 on the remodel area, then multiply the remodel hours by 1.15. Sum the two to get total hours. Allow the user to override this factor if desired.

Distribute the hours across project phases using the default percentages (8â€¯% Discovery, 8â€¯% Conceptual, 34â€¯% Creative Schematic, etc.), and allocate to roles (Designer1, Designer2, Architect, Engineer, Principal) using the leverage percentages from the spreadsheet, rounding each roleâ€™s hours individually.